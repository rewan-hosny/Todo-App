{"version":3,"sources":["user-service.service.ts"],"names":["core_1","require","UserService","http","jwtHelper","localStorage","router","this","baseUrl","prototype","register","email","name","password","_this","post","responseType","subscribe","response","token","decodedToken","decodeToken","setItem","navigate","error","console","log","login","isAuthenticated","getItem","tokenWithoutBearer","replace","isTokenExpired","logout","removeItem","__decorate","Injectable","providedIn","exports"],"mappings":"6YAAA,IAAAA,OAAAC,QAAA,iBAWAC,YAAA,WAGE,SAAAA,EAAoBC,EAA0BC,EAAoCC,EAA2CC,GAAzGC,KAAAJ,KAAAA,EAA0BI,KAAAH,UAAAA,EAAoCG,KAAAF,aAAAA,EAA2CE,KAAAD,OAAAA,EAFvHC,KAAAC,QAAU,8BAuElB,OAnEAN,EAAAO,UAAAC,SAAA,SAASC,EAAeC,EAAcC,GAAtC,IAAAC,EAAAP,KACEA,KAAKJ,KAAKY,KAAQR,KAAKC,QAAO,gBAAiB,CAAEG,MAAOA,EAAOC,KAAMA,EAAMC,SAAUA,GACnF,CAAEG,aAAc,SACfC,UAAU,SAAAC,GACT,IAAMC,EAAQD,EAEd,IACE,IAAME,EAAeN,EAAKV,UAAUiB,YAAYF,GAChDd,aAAaiB,QAAQ,gBAAiBH,GACtCd,aAAaiB,QAAQ,OAAQF,EAAa,+DAC1Cf,aAAaiB,QAAQ,SAAUF,EAAa,yEAC5CN,EAAKR,OAAOiB,SAAS,CAAC,UACtB,MAAOC,GACPC,QAAQC,IAAIF,GACZC,QAAQC,IAAIR,KAEb,SAAAM,GACDC,QAAQC,IAAIF,MAMhBtB,EAAAO,UAAAkB,MAAA,SAAMhB,EAAcE,GAApB,IAAAC,EAAAP,KAEEA,KAAKJ,KAAKY,KAAK,wCACb,CAAEJ,MAAOA,EAAOE,SAAUA,GAC1B,CAAEG,aAAc,SACfC,UAAU,SAACC,GACV,IAAMC,EAAQD,EACd,GAAIC,EAAO,CAEb,IAAMC,EAAeN,EAAKV,UAAUiB,YAAYF,GACjDd,aAAaiB,QAAQ,gBAAiBH,GACvCd,aAAaiB,QAAQ,OAAQF,EAAa,+DACpCf,aAAaiB,QAAQ,SAAUF,EAAa,yEAChDN,EAAKR,OAAOiB,SAAS,CAAC,cAkB5BrB,EAAAO,UAAAmB,gBAAA,WACE,IAAMT,EAAQd,aAAawB,QAAQ,iBACnC,IAAKV,EACH,OAAO,EAET,IAAMW,EAAqBX,EAAMY,QAAQ,UAAW,IACpD,OAAQxB,KAAKH,UAAU4B,eAAeF,IAItC5B,EAAAO,UAAAwB,OAAA,WACE5B,aAAa6B,WAAW,kBAtEfhC,EAAWiC,WAAA,CAHvBnC,OAAAoC,WAAW,CACVC,WAAY,UAEDnC,GAAb,GAAaoC,QAAApC,YAAAA","file":"user-service.service.min.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { JwtHelperService } from '@auth0/angular-jwt';\nimport axios from 'axios';\nimport { LocalStorageService } from 'ngx-webstorage';\nimport { Router } from '@angular/router';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UserService {\nprivate baseUrl = 'https://localhost:7101/api/';\n\n  constructor(private http: HttpClient, private jwtHelper: JwtHelperService,private localStorage: LocalStorageService, private router: Router) {}\n\nregister(email: string, name: string, password: string) {\n  this.http.post(`${this.baseUrl}Auth/register`, { email: email, name: name, password: password },\n    { responseType: 'text' })\n    .subscribe(response => {\n      const token = response;\n\n      try {\n        const decodedToken = this.jwtHelper.decodeToken(token);\n        localStorage.setItem('Authorization', token);\n        localStorage.setItem('name', decodedToken[\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\"]);\n        localStorage.setItem('userid', decodedToken[\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\"]);\n        this.router.navigate(['/todo']);\n      } catch (error) {\n        console.log(error);\n        console.log(response);\n      }\n    }, error => {\n      console.log(error);\n    });\n}\n\n\n\n  login(email: string,password: string) {\n    \n    this.http.post('https://localhost:7101/api/Auth/login',\n      { email: email, password: password },\n      { responseType: 'text' })\n      .subscribe((response) => {\n        const token = response;\n        if (token) {\n    \n      const decodedToken = this.jwtHelper.decodeToken(token);\n     localStorage.setItem('Authorization', token);\n    localStorage.setItem('name', decodedToken[\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\"]);\n          localStorage.setItem('userid', decodedToken[\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\"]);\n      this.router.navigate(['/todo']);\n}\n\n      },\n      );\n  }\n\n  // login(user: any) {\n  //   return axios.post(`${this.baseUrl}Auth/login`, user)\n  //     .then(response => {\n  //       const token = response.data;\n  //       localStorage.setItem('Authorization', token);\n  //       return true;\n  //     })\n  //    .catch(error => {\n  //     return error.response.data.error;\n  //   });\n  // }\nisAuthenticated(): boolean {\n  const token = localStorage.getItem('Authorization');\n  if (!token) {\n    return false;\n  }\n  const tokenWithoutBearer = token.replace('Bearer ', '');\n  return !this.jwtHelper.isTokenExpired(tokenWithoutBearer);\n}\n\n\n  logout() {\n    localStorage.removeItem('Authorization');\n  }\n}\n"]}